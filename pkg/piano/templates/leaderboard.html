{{define "content"}}
<div class="content">
    <h1>üèÜ Piano Leaderboard</h1>

    <div style="margin-bottom: 2rem;">
        <form method="GET" action="/leaderboard" style="display: flex; gap: 1rem;">
            <select name="metric" style="flex: 1;">
                <option value="score" {{if eq .Metric "score"}}selected{{end}}>Overall Score</option>
                <option value="accuracy" {{if eq .Metric "accuracy"}}selected{{end}}>Accuracy</option>
                <option value="tempo" {{if eq .Metric "tempo"}}selected{{end}}>Tempo Control</option>
                <option value="lessons" {{if eq .Metric "lessons"}}selected{{end}}>Total Lessons</option>
            </select>
            <button type="submit" class="btn">Sort</button>
        </form>
    </div>

    {{if .LeaderboardEntries}}
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <th style="padding: 1rem; text-align: center;">Rank</th>
                    <th style="padding: 1rem; text-align: left;">User</th>
                    <th style="padding: 1rem; text-align: center;">Level</th>
                    <th style="padding: 1rem; text-align: right;">Avg Score</th>
                    <th style="padding: 1rem; text-align: right;">Best Score</th>
                    <th style="padding: 1rem; text-align: right;">Accuracy</th>
                    <th style="padding: 1rem; text-align: right;">Lessons</th>
                </tr>
            </thead>
            <tbody>
                {{range $index, $entry := .LeaderboardEntries}}
                    <tr style="border-bottom: 1px solid #eee; {{if eq (mod $index 2) 0}}background: #f9f9f9;{{end}}">
                        <td style="padding: 1rem; text-align: center; font-weight: bold;">
                            {{if eq $index 0}}ü•á{{else if eq $index 1}}ü•à{{else if eq $index 2}}ü•â{{else}}#{{add $index 1}}{{end}}
                        </td>
                        <td style="padding: 1rem;">
                            <strong>User {{$entry.UserID}}</strong>
                            <br><small style="color: #999;">{{$entry.TotalPracticedMinutes}} min practiced</small>
                        </td>
                        <td style="padding: 1rem; text-align: center;">
                            <span style="text-transform: capitalize;">{{$entry.CurrentLevel}}</span>
                        </td>
                        <td style="padding: 1rem; text-align: right;">{{printf "%.1f" $entry.AverageScore}}</td>
                        <td style="padding: 1rem; text-align: right;">{{printf "%.1f" $entry.BestScore}}</td>
                        <td style="padding: 1rem; text-align: right;">{{printf "%.1f" $entry.AverageAccuracy}}%</td>
                        <td style="padding: 1rem; text-align: right;">{{$entry.TotalLessonsCompleted}}</td>
                    </tr>
                {{end}}
            </tbody>
        </table>
    {{else}}
        <div class="alert alert-info">
            No leaderboard data available yet. Start practicing to appear on the leaderboard!
        </div>
    {{end}}

    <div style="background: #f9f9f9; padding: 1.5rem; border-radius: 8px; margin: 2rem 0;">
        <h2>üéØ How to Climb the Leaderboard</h2>
        <ul style="margin: 1rem 0; margin-left: 2rem;">
            <li>Practice consistently - more lessons = higher ranking</li>
            <li>Improve your accuracy - hit more correct notes</li>
            <li>Master tempo control - match the song's target BPM</li>
            <li>Learn advanced pieces - challenge yourself with harder songs</li>
            <li>Perfect your technique - aim for 100% score on each lesson</li>
        </ul>
    </div>
</div>

<script>
    function mod(n, m) {
        return n % m;
    }

    function add(n, m) {
        return n + m;
    }
</script>
{{end}}
